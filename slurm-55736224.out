Loading rhel7/default-gpu
  Loading requirement: dot slurm turbovnc/2.0.1 vgl/2.5.1/64 singularity/current
    rhel7/global cuda/8.0 gcc-5.4.0-gcc-4.8.5-fis24gg
    openmpi-1.10.7-gcc-5.4.0-jdc7f4f cmake/latest
2022-02-24 03:17:21,339 INFO     | building dictionary first...
2022-02-24 03:17:21,354 INFO     | No model with opt yet at: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model(.opt)
2022-02-24 03:17:21,371 WARNING  | your model is being loaded with opts that do not exist in the model you are initializing the weights with: allow_missing_init_opts: False,download_path: None,loglevel: info,verbose: False,is_debug: False,datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data,evaltask: None,final_extra_opt: ,eval_batchsize: 10,eval_dynamic_batching: None,num_workers: 0,display_examples: False,num_epochs: 8.0,max_train_time: 43200.0,max_train_steps: -1,log_every_n_steps: 50,validation_every_n_secs: -1,validation_every_n_steps: -1,save_every_n_secs: -1,save_after_valid: True,validation_every_n_epochs: 0.25,validation_max_exs: -1,short_final_eval: False,validation_patience: 10,validation_metric: ppl,validation_metric_mode: max,validation_cutoff: 1.0,load_from_checkpoint: True,validation_share_agent: False,metrics: default,aggregate_micro: False,tensorboard_log: False,tensorboard_logdir: None,wandb_log: False,wandb_name: None,wandb_project: None,wandb_entity: None,dict_maxexs: -1,dict_include_valid: False,dict_include_test: False,log_every_n_secs: 10.0,mutators: None,fromfile_datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data,fromfile_datatype_extension: True,checkpoint_activations: False,beam_block_full_context: True,beam_block_list_filename: None,interactive_mode: False,history_reversed: False,special_tok_lst: None,bpe_dropout: None
2022-02-24 03:17:21,371 WARNING  | your model is being loaded with opts that differ from the model you are initializing the weights with. Add the following args to your run command to change this: 
--show-advanced-args False --task None --numthreads 1 --multitask-weights 1 --batchsize 1 --dropout 0.05 --model-parallel False --beam-size 10 --beam-min-length 20 --beam-context-block-ngram 3 --beam-block-ngram 3 --skip-generation False --fp16 False --fp16-impl apex --force-fp16-tokens True --optimizer sgd --learningrate 1 --bpe-vocab /tmp/meena_converter/bpe-vocab.json --bpe-merge /tmp/meena_converter/bpe-merges.txt --bpe-add-prefix-space True --max-lr-steps -1 --warmup-updates -1 --update-freq 1 --parlai-home /private/home/roller/working/parlai
2022-02-24 03:17:22,012 INFO     | Using CUDA
2022-02-24 03:17:22,027 INFO     | loading dictionary from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model.dict
2022-02-24 03:17:22,062 INFO     | num words = 8008
2022-02-24 03:18:12,029 INFO     | Total parameters: 2,696,268,800 (2,695,613,440 trainable)
2022-02-24 03:18:12,030 INFO     | Loading existing model params from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model
2022-02-24 03:18:21,062 WARNING  | Detected a fine-tune run. Resetting the optimizer.
2022-02-24 03:18:21,062 WARNING  | Optimizer was reset. Also resetting LR scheduler.
2022-02-24 03:18:21,073 INFO     | Opt:
2022-02-24 03:18:21,074 INFO     |     activation: gelu
2022-02-24 03:18:21,074 INFO     |     adafactor_eps: '(1e-30, 0.001)'
2022-02-24 03:18:21,074 INFO     |     adam_eps: 1e-08
2022-02-24 03:18:21,074 INFO     |     add_p1_after_newln: False
2022-02-24 03:18:21,074 INFO     |     aggregate_micro: False
2022-02-24 03:18:21,074 INFO     |     allow_missing_init_opts: False
2022-02-24 03:18:21,074 INFO     |     attention_dropout: 0.0
2022-02-24 03:18:21,074 INFO     |     batchsize: 32
2022-02-24 03:18:21,074 INFO     |     beam_block_full_context: True
2022-02-24 03:18:21,074 INFO     |     beam_block_list_filename: None
2022-02-24 03:18:21,074 INFO     |     beam_block_ngram: -1
2022-02-24 03:18:21,074 INFO     |     beam_context_block_ngram: -1
2022-02-24 03:18:21,074 INFO     |     beam_delay: 30
2022-02-24 03:18:21,074 INFO     |     beam_length_penalty: 0.65
2022-02-24 03:18:21,074 INFO     |     beam_min_length: 1
2022-02-24 03:18:21,074 INFO     |     beam_size: 20
2022-02-24 03:18:21,074 INFO     |     betas: '(0.9, 0.999)'
2022-02-24 03:18:21,074 INFO     |     bpe_add_prefix_space: None
2022-02-24 03:18:21,074 INFO     |     bpe_debug: False
2022-02-24 03:18:21,074 INFO     |     bpe_dropout: None
2022-02-24 03:18:21,074 INFO     |     bpe_merge: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model.dict-merges.txt
2022-02-24 03:18:21,075 INFO     |     bpe_vocab: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model.dict-vocab.json
2022-02-24 03:18:21,075 INFO     |     checkpoint_activations: False
2022-02-24 03:18:21,075 INFO     |     compute_tokenized_bleu: False
2022-02-24 03:18:21,075 INFO     |     datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data
2022-02-24 03:18:21,075 INFO     |     datatype: train
2022-02-24 03:18:21,075 INFO     |     delimiter: '  '
2022-02-24 03:18:21,075 INFO     |     dict_class: parlai.core.dict:DictionaryAgent
2022-02-24 03:18:21,075 INFO     |     dict_endtoken: __end__
2022-02-24 03:18:21,075 INFO     |     dict_file: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model.dict
2022-02-24 03:18:21,075 INFO     |     dict_include_test: False
2022-02-24 03:18:21,075 INFO     |     dict_include_valid: False
2022-02-24 03:18:21,075 INFO     |     dict_initpath: None
2022-02-24 03:18:21,075 INFO     |     dict_language: english
2022-02-24 03:18:21,075 INFO     |     dict_loaded: True
2022-02-24 03:18:21,075 INFO     |     dict_lower: False
2022-02-24 03:18:21,075 INFO     |     dict_max_ngram_size: -1
2022-02-24 03:18:21,075 INFO     |     dict_maxexs: -1
2022-02-24 03:18:21,075 INFO     |     dict_maxtokens: -1
2022-02-24 03:18:21,075 INFO     |     dict_minfreq: 0
2022-02-24 03:18:21,075 INFO     |     dict_nulltoken: __null__
2022-02-24 03:18:21,075 INFO     |     dict_starttoken: __start__
2022-02-24 03:18:21,075 INFO     |     dict_textfields: text,labels
2022-02-24 03:18:21,075 INFO     |     dict_tokenizer: bytelevelbpe
2022-02-24 03:18:21,075 INFO     |     dict_unktoken: __unk__
2022-02-24 03:18:21,075 INFO     |     display_examples: False
2022-02-24 03:18:21,075 INFO     |     download_path: None
2022-02-24 03:18:21,075 INFO     |     dropout: 0.1
2022-02-24 03:18:21,075 INFO     |     dynamic_batching: None
2022-02-24 03:18:21,075 INFO     |     embedding_projection: random
2022-02-24 03:18:21,076 INFO     |     embedding_size: 2560
2022-02-24 03:18:21,076 INFO     |     embedding_type: random
2022-02-24 03:18:21,076 INFO     |     embeddings_scale: True
2022-02-24 03:18:21,076 INFO     |     eval_batchsize: 10
2022-02-24 03:18:21,076 INFO     |     eval_dynamic_batching: None
2022-02-24 03:18:21,076 INFO     |     evaltask: None
2022-02-24 03:18:21,076 INFO     |     ffn_size: 10240
2022-02-24 03:18:21,076 INFO     |     final_extra_opt: 
2022-02-24 03:18:21,076 INFO     |     force_fp16_tokens: False
2022-02-24 03:18:21,076 INFO     |     fp16: True
2022-02-24 03:18:21,076 INFO     |     fp16_impl: safe
2022-02-24 03:18:21,076 INFO     |     fromfile_datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data
2022-02-24 03:18:21,076 INFO     |     fromfile_datatype_extension: True
2022-02-24 03:18:21,076 INFO     |     gpu: -1
2022-02-24 03:18:21,076 INFO     |     gradient_clip: 0.1
2022-02-24 03:18:21,076 INFO     |     hide_labels: False
2022-02-24 03:18:21,076 INFO     |     history_add_global_end_token: end
2022-02-24 03:18:21,076 INFO     |     history_reversed: False
2022-02-24 03:18:21,076 INFO     |     history_size: -1
2022-02-24 03:18:21,076 INFO     |     image_cropsize: 224
2022-02-24 03:18:21,076 INFO     |     image_mode: raw
2022-02-24 03:18:21,076 INFO     |     image_size: 256
2022-02-24 03:18:21,076 INFO     |     inference: beam
2022-02-24 03:18:21,076 INFO     |     init_model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model
2022-02-24 03:18:21,076 INFO     |     init_opt: None
2022-02-24 03:18:21,076 INFO     |     interactive_mode: False
2022-02-24 03:18:21,076 INFO     |     invsqrt_lr_decay_gamma: -1
2022-02-24 03:18:21,076 INFO     |     is_debug: False
2022-02-24 03:18:21,076 INFO     |     label_truncate: 128
2022-02-24 03:18:21,076 INFO     |     learn_positional_embeddings: False
2022-02-24 03:18:21,077 INFO     |     learningrate: 7e-06
2022-02-24 03:18:21,077 INFO     |     load_from_checkpoint: True
2022-02-24 03:18:21,077 INFO     |     log_every_n_secs: 10.0
2022-02-24 03:18:21,077 INFO     |     log_every_n_steps: 50
2022-02-24 03:18:21,077 INFO     |     loglevel: info
2022-02-24 03:18:21,077 INFO     |     lr_scheduler: reduceonplateau
2022-02-24 03:18:21,077 INFO     |     lr_scheduler_decay: 0.5
2022-02-24 03:18:21,077 INFO     |     lr_scheduler_patience: 3
2022-02-24 03:18:21,077 INFO     |     max_train_steps: -1
2022-02-24 03:18:21,077 INFO     |     max_train_time: 43200.0
2022-02-24 03:18:21,077 INFO     |     metrics: default
2022-02-24 03:18:21,077 INFO     |     model: transformer/generator
2022-02-24 03:18:21,077 INFO     |     model_file: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model
2022-02-24 03:18:21,077 INFO     |     model_parallel: True
2022-02-24 03:18:21,077 INFO     |     momentum: 0
2022-02-24 03:18:21,077 INFO     |     multitask_weights: '(1.0, 3.0, 3.0, 3.0)'
2022-02-24 03:18:21,077 INFO     |     mutators: None
2022-02-24 03:18:21,077 INFO     |     n_decoder_layers: 24
2022-02-24 03:18:21,077 INFO     |     n_encoder_layers: 2
2022-02-24 03:18:21,077 INFO     |     n_heads: 32
2022-02-24 03:18:21,077 INFO     |     n_layers: 2
2022-02-24 03:18:21,077 INFO     |     n_positions: 128
2022-02-24 03:18:21,077 INFO     |     n_segments: 0
2022-02-24 03:18:21,077 INFO     |     nesterov: True
2022-02-24 03:18:21,077 INFO     |     no_cuda: False
2022-02-24 03:18:21,077 INFO     |     num_epochs: 8.0
2022-02-24 03:18:21,077 INFO     |     num_workers: 0
2022-02-24 03:18:21,077 INFO     |     nus: (0.7,)
2022-02-24 03:18:21,077 INFO     |     optimizer: adam
2022-02-24 03:18:21,078 INFO     |     output_scaling: 1.0
2022-02-24 03:18:21,078 INFO     |     override: "{'task': 'fromfile:parlaiformat', 'fromfile_datapath': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data', 'fromfile_datatype_extension': True, 'model': 'transformer/generator', 'model_file': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model', 'init_model': 'zoo:blender/reddit_3B/model', 'dict_file': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model.dict', 'multitask_weights': (1.0, 3.0, 3.0, 3.0), 'validation_every_n_epochs': 0.25, 'attention_dropout': 0.0, 'embedding_size': 2560, 'ffn_size': 10240, 'variant': 'prelayernorm', 'n_heads': 32, 'n_positions': 128, 'n_encoder_layers': 2, 'n_decoder_layers': 24, 'history_add_global_end_token': 'end', 'delimiter': '  ', 'dict_tokenizer': 'bytelevelbpe', 'dropout': 0.1, 'label_truncate': 128, 'log_every_n_secs': 10.0, 'lr_scheduler': 'reduceonplateau', 'lr_scheduler_patience': 3, 'relu_dropout': 0.0, 'activation': 'gelu', 'model_parallel': True, 'save_after_valid': True, 'text_truncate': 128, 'truncate': 128, 'update_freq': 2, 'gradient_clip': 0.1, 'skip_generation': True, 'validation_patience': 10, 'validation_metric': 'ppl', 'validation_metric_mode': 'max', 'learningrate': 7e-06, 'optimizer': 'adam', 'warmup_updates': 100, 'max_train_time': 43200.0, 'num_epochs': 8.0, 'batchsize': 32, 'eval_batchsize': 10, 'fp16': True, 'beam_size': 20, 'inference': 'beam'}"
2022-02-24 03:18:21,078 INFO     |     parlai_home: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages
2022-02-24 03:18:21,078 INFO     |     person_tokens: False
2022-02-24 03:18:21,078 INFO     |     rank_candidates: False
2022-02-24 03:18:21,078 INFO     |     relu_dropout: 0.0
2022-02-24 03:18:21,078 INFO     |     save_after_valid: True
2022-02-24 03:18:21,078 INFO     |     save_every_n_secs: -1
2022-02-24 03:18:21,078 INFO     |     share_word_embeddings: True
2022-02-24 03:18:21,078 INFO     |     short_final_eval: False
2022-02-24 03:18:21,078 INFO     |     skip_generation: True
2022-02-24 03:18:21,078 INFO     |     special_tok_lst: None
2022-02-24 03:18:21,078 INFO     |     split_lines: False
2022-02-24 03:18:21,078 INFO     |     starttime: Feb24_03-17
2022-02-24 03:18:21,078 INFO     |     task: fromfile:parlaiformat
2022-02-24 03:18:21,078 INFO     |     temperature: 1.0
2022-02-24 03:18:21,078 INFO     |     tensorboard_log: False
2022-02-24 03:18:21,078 INFO     |     tensorboard_logdir: None
2022-02-24 03:18:21,078 INFO     |     text_truncate: 128
2022-02-24 03:18:21,078 INFO     |     topk: 10
2022-02-24 03:18:21,078 INFO     |     topp: 0.9
2022-02-24 03:18:21,078 INFO     |     truncate: 128
2022-02-24 03:18:21,078 INFO     |     update_freq: 2
2022-02-24 03:18:21,078 INFO     |     use_reply: label
2022-02-24 03:18:21,078 INFO     |     validation_cutoff: 1.0
2022-02-24 03:18:21,078 INFO     |     validation_every_n_epochs: 0.25
2022-02-24 03:18:21,078 INFO     |     validation_every_n_secs: -1
2022-02-24 03:18:21,079 INFO     |     validation_every_n_steps: -1
2022-02-24 03:18:21,079 INFO     |     validation_max_exs: -1
2022-02-24 03:18:21,079 INFO     |     validation_metric: ppl
2022-02-24 03:18:21,079 INFO     |     validation_metric_mode: max
2022-02-24 03:18:21,079 INFO     |     validation_patience: 10
2022-02-24 03:18:21,079 INFO     |     validation_share_agent: False
2022-02-24 03:18:21,079 INFO     |     variant: prelayernorm
2022-02-24 03:18:21,079 INFO     |     verbose: False
2022-02-24 03:18:21,079 INFO     |     wandb_entity: None
2022-02-24 03:18:21,079 INFO     |     wandb_log: False
2022-02-24 03:18:21,079 INFO     |     wandb_name: None
2022-02-24 03:18:21,079 INFO     |     wandb_project: None
2022-02-24 03:18:21,079 INFO     |     warmup_rate: 0.0001
2022-02-24 03:18:21,079 INFO     |     warmup_updates: 100
2022-02-24 03:18:21,079 INFO     |     weight_decay: None
2022-02-24 03:18:21,229 INFO     | Current ParlAI commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 03:18:21,286 INFO     | Current internal commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 03:18:21,343 INFO     | Current fb commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 03:18:21,370 INFO     | creating task(s): fromfile:parlaiformat
2022-02-24 03:18:21,515 INFO     | Loading ParlAI text data: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_train.txt
2022-02-24 03:18:21,783 INFO     | training...
2022-02-24 03:18:32,326 INFO     | time:10s total_exs:224 total_steps:3 epochs:0.03 time_left:2590s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   50.08     1  1380 952.1  .03571       6.96  21.9  224             32768  5.754   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277  21.8  2.72 2.107e-07 697.6 481.3       0          0 15.17      .4405   
    token_em  total_train_updates  tpb  tps   ups  
           0                    3 2077 1433 .3137

2022-02-24 03:18:42,839 INFO     | time:21s total_exs:736 total_steps:11 epochs:0.11 time_left:1582s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   46.39     1  1423  2171   .0332      1.914 48.82  512             32768  5.735   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.97 2.684 7.706e-07 703.1  1073       0          0 14.64      .4484   
    token_em  total_train_updates  tpb  tps   ups  
           0                   11 2126 3244 .8085

2022-02-24 03:18:53,111 INFO     | time:31s total_exs:1248 total_steps:19 epochs:0.18 time_left:1375s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   51.31     1  1466  2289  .03906      5.512 49.97  512             32768  5.268   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen  ppl  token_acc  \
      .2305 21.51 2.534 1.331e-06 688.4  1075       0          0 12.6      .4654   
    token_em  total_train_updates  tpb  tps   ups  
           0                   19 2154 3364 .8237

2022-02-24 03:19:02,842 INFO     | time:41s total_exs:1760 total_steps:27 epochs:0.25 time_left:1266s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   44.15     1  1388  2289  .01758      .7598 52.76  512             32768  4.075   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.91 2.317 1.891e-06 701.2  1156       0          0 10.14      .5017   
    token_em  total_train_updates  tpb  tps   ups  
           0                   27 2090 3445 .8722

2022-02-24 03:19:02,842 INFO     | creating task(s): fromfile:parlaiformat
2022-02-24 03:19:02,843 INFO     | Loading ParlAI text data: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_valid.txt
2022-02-24 03:19:02,905 INFO     | running eval: valid
2022-02-24 03:19:03,437 WARNING  | --skip-generation true produces limited metrics
2022-02-24 03:20:08,350 INFO     | eval completed in 65.45s
2022-02-24 03:20:08,350 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1364   .0420      3.583 30.57 2000    .1930 21.92  2.41 1.891e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2   670       0          0 11.13      .4879         0                   27   
     tpb  tps  
   665.5 2034

2022-02-24 03:20:08,350 SUCCESS  | new best ppl: 11.13
2022-02-24 03:20:08,351 INFO     | saving best valid model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model
2022-02-24 03:20:08,351 INFO     | Saving dictionary to /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.dict
2022-02-24 03:20:51,721 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:20:51,722 INFO     | Saving dictionary to /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint.dict
2022-02-24 03:21:45,008 INFO     | time:203s total_exs:2304 total_steps:36 epochs:0.33 time_left:4737s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   53.32     1  1450  2349  .04963      8.009 51.84  544             32768  3.456   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2304 21.83 2.141 2.52e-06 698.7  1132       0          0 8.509      .5343   
    token_em  total_train_updates  tpb  tps   ups  
           0                   36 2149 3481 .8584

2022-02-24 03:21:55,508 INFO     | time:214s total_exs:2848 total_steps:44 epochs:0.41 time_left:3989s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.97     1  1440  2337  .04228      4.971 51.92  544             32768  3.128   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.36 1.993 3.08e-06 715.6  1161       0          0 7.339      .5582   
    token_em  total_train_updates  tpb  tps   ups  
           0                   44 2156 3498 .8044

2022-02-24 03:22:05,873 INFO     | time:224s total_exs:3392 total_steps:53 epochs:0.48 time_left:3476s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.23     1  1496  2460  .04228      2.469 52.61  544             32768  2.944   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.32 1.914 3.71e-06 682.1  1121       0          0 6.783      .5759   
    token_em  total_train_updates  tpb  tps   ups  
     .007353                   53 2179 3581 .8711

2022-02-24 03:22:08,358 INFO     | time:227s total_exs:3520 total_steps:55 epochs:0.50 time_left:3378s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   46.39     1  1468  2385  .03125      .5312    52  128             32768  2.876   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 20.95 1.938 3.85e-06 670.2  1089       0          0 6.942      .5550   
    token_em  total_train_updates  tpb  tps   ups  
           0                   55 2138 3474 .8155

2022-02-24 03:22:08,359 INFO     | running eval: valid
2022-02-24 03:23:13,284 INFO     | eval completed in 64.93s
2022-02-24 03:23:13,284 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1375   .0420      3.583 30.81 2000    .1930 21.92 2.212 3.85e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 675.4       0          0 9.135      .5205     .0005                   55   
     tpb  tps  
   665.5 2050

2022-02-24 03:23:13,285 SUCCESS  | new best ppl: 9.135 (previous best was 11.13)
2022-02-24 03:23:13,285 INFO     | saving best valid model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model
2022-02-24 03:23:55,557 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:24:49,075 INFO     | time:387s total_exs:4064 total_steps:63 epochs:0.58 time_left:4950s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   46.82     1  1429  2356  .03125      2.149 52.74  544             32768  2.886   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.88 1.826 4.41e-06 700.1  1154       0          0 6.211      .5926   
    token_em  total_train_updates  tpb  tps   ups  
      .01838                   63 2129 3509 .8170

2022-02-24 03:24:59,422 INFO     | time:398s total_exs:4608 total_steps:72 epochs:0.66 time_left:4435s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   54.13     1  1440  2372   .0386      9.125 52.71  544             32768  2.714   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.56 1.692 5.04e-06 689.8  1136       0          0 5.429      .6122   
    token_em  total_train_updates  tpb  tps   ups  
      .01471                   72 2130 3508 .8728

2022-02-24 03:25:09,684 INFO     | time:408s total_exs:5152 total_steps:80 epochs:0.74 time_left:4026s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   47.49     1  1445  2399  .03309      2.342 53.13  544             32768  2.748   
    gpu_mem  llen  loss      lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.63 1.629 5.6e-06 692.1  1149       0          0 5.098      .6336   
    token_em  total_train_updates  tpb  tps   ups  
       .0239                   80 2137 3548 .8233

2022-02-24 03:25:12,094 INFO     | time:410s total_exs:5280 total_steps:82 epochs:0.75 time_left:3942s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   57.59     1  1334  2238  .04688      15.91 53.69  128             32768  2.757   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2304 22.69 1.678 5.74e-06   726  1218       0          0 5.353      .6309   
    token_em  total_train_updates  tpb  tps   ups  
      .02344                   82 2060 3456 1.073

2022-02-24 03:25:12,094 INFO     | running eval: valid
2022-02-24 03:26:16,893 INFO     | eval completed in 64.80s
2022-02-24 03:26:16,893 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1378   .0420      3.583 30.87 2000    .1930 21.92 2.166 5.74e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 676.7       0          0 8.726      .5343     .0005                   82   
     tpb  tps  
   665.5 2054

2022-02-24 03:26:16,893 SUCCESS  | new best ppl: 8.726 (previous best was 9.135)
2022-02-24 03:26:16,893 INFO     | saving best valid model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model
2022-02-24 03:27:00,432 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:27:55,756 INFO     | time:574s total_exs:5792 total_steps:90 epochs:0.83 time_left:4976s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   51.46     1  1469  2326  .04688      5.559 50.67  512             32768  2.719   
    gpu_mem  llen  loss      lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.88 1.586 6.3e-06   700  1108       0          0 4.882      .6359   
    token_em  total_train_updates  tpb  tps   ups  
      .05859                   90 2169 3434 .8355

2022-02-24 03:28:06,238 INFO     | time:584s total_exs:6336 total_steps:99 epochs:0.91 time_left:4581s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   48.65     1  1438  2338  .04044      3.702 52.02  544             32768  2.697   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.49 1.505 6.93e-06 687.8  1118       0          0 4.502      .6558   
    token_em  total_train_updates  tpb  tps   ups  
      .01654                   99 2126 3456 .8614

2022-02-24 03:28:16,614 INFO     | time:595s total_exs:6880 total_steps:107 epochs:0.98 time_left:4247s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   53.55     1  1488  2444  .04779       7.04 52.56  544             32768  2.716   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2340  21.9  1.57 6.93e-06 700.9  1151       0          0 4.806      .6444   
    token_em  total_train_updates  tpb  tps   ups  
     .007353                  107 2189 3596 .8142

2022-02-24 03:28:19,692 INFO     | time:598s total_exs:7040 total_steps:110 epochs:1.01 time_left:4158s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   53.74     1  1376  2252  .03125      10.76 52.39  160             32768  2.897   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 20.55 1.664 6.93e-06 657.6  1077       0          0 5.282      .6192   
    token_em  total_train_updates  tpb  tps   ups  
      .03125                  110 2033 3329 .9854

2022-02-24 03:28:19,693 INFO     | running eval: valid
2022-02-24 03:29:24,752 INFO     | eval completed in 65.06s
2022-02-24 03:29:24,752 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1372   .0420      3.583 30.75 2000    .1930 21.92 2.147 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2   674       0          0 8.557      .5391     .0025                  110   
     tpb  tps  
   665.5 2046

2022-02-24 03:29:24,752 SUCCESS  | new best ppl: 8.557 (previous best was 8.726)
2022-02-24 03:29:24,752 INFO     | saving best valid model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model
2022-02-24 03:30:06,962 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:31:01,496 INFO     | time:760s total_exs:7584 total_steps:118 epochs:1.08 time_left:4850s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.48     1  1407  2329  .04412      5.524 52.99  544             32768  2.707   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.45 1.443 6.93e-06 718.4  1190       0          0 4.232      .6682   
    token_em  total_train_updates  tpb  tps   ups  
       .0625                  118 2125 3519 .8253

2022-02-24 03:31:11,966 INFO     | time:770s total_exs:8128 total_steps:127 epochs:1.16 time_left:4536s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
    50.2     1  1504  2449  .04044        3.2  52.1  544             32768  2.793   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen  ppl  token_acc  \
      .2305 21.51 1.456 6.93e-06 688.2  1120       0          0 4.29      .6652   
    token_em  total_train_updates  tpb  tps   ups  
      .02757                  127 2192 3569 .8627

2022-02-24 03:31:22,381 INFO     | time:781s total_exs:8672 total_steps:135 epochs:1.24 time_left:4260s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   50.63     1  1418  2320  .04228      6.311 52.36  544             32768  2.859   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2276 21.86 1.404 6.93e-06 699.5  1145       0          0 4.071      .6742   
    token_em  total_train_updates  tpb  tps   ups  
     .009191                  135 2118 3465 .8113

2022-02-24 03:31:24,792 INFO     | time:783s total_exs:8800 total_steps:137 epochs:1.26 time_left:4200s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.63     1  1428  2394  .03125          8 53.64  128             32768  2.786   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277  21.8 1.401 6.93e-06 697.8  1170       0          0 4.059      .6761   
    token_em  total_train_updates  tpb  tps   ups  
      .03906                  137 2126 3564 1.076

2022-02-24 03:31:24,793 INFO     | running eval: valid
2022-02-24 03:32:29,968 INFO     | eval completed in 65.18s
2022-02-24 03:32:29,968 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1370   .0420      3.583 30.69 2000    .1930 21.92 2.147 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 672.8       0          0 8.559      .5430     .0005                  137   
     tpb  tps  
   665.5 2043

2022-02-24 03:32:29,968 REPORT   | did not beat best ppl: 8.5572 impatience: 1
2022-02-24 03:32:29,968 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:33:26,779 INFO     | time:905s total_exs:9248 total_steps:144 epochs:1.32 time_left:4575s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   45.48     1  1398  1936  .02902      1.801 44.32  448             32768  2.815   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2276 21.91 1.374 6.93e-06 701.1   971       0          0 3.953      .6792   
    token_em  total_train_updates  tpb  tps   ups  
      .01562                  144 2099 2907 .7484

2022-02-24 03:33:37,516 INFO     | time:916s total_exs:9728 total_steps:152 epochs:1.39 time_left:4356s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.55     1  1463  2049   .0500      3.827 44.82  480             32768  2.853   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.84  1.36 6.93e-06   699 979.1       0          0 3.895      .6850   
    token_em  total_train_updates  tpb  tps   ups  
      .02917                  152 2162 3029 .7486

2022-02-24 03:33:47,706 INFO     | time:926s total_exs:10208 total_steps:159 epochs:1.46 time_left:4154s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.68     1  1368  2020  .04167      6.921 47.23  480             32768  2.713   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2276 22.33 1.309 6.93e-06 714.6  1055       0          0 3.704      .6939   
    token_em  total_train_updates  tpb  tps   ups  
      .03125                  159 2083 3075 .7322

2022-02-24 03:33:55,495 INFO     | time:934s total_exs:10560 total_steps:165 epochs:1.51 time_left:4018s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.48     1  1497  2123  .05114       5.69 45.36  352             32768   2.75   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 22.26  1.35 6.93e-06 712.3  1010       0          0 3.856      .6851   
    token_em  total_train_updates  tpb  tps   ups  
       .0483                  165 2210 3132 .7748

2022-02-24 03:33:55,495 INFO     | running eval: valid
2022-02-24 03:35:02,822 INFO     | eval completed in 67.33s
2022-02-24 03:35:02,822 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1326   .0420      3.583 29.71 2000    .1930 21.92 2.159 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 651.3       0          0 8.659      .5406     .0030                  165   
     tpb  tps  
   665.5 1977

2022-02-24 03:35:02,822 REPORT   | did not beat best ppl: 8.5572 impatience: 2
2022-02-24 03:35:02,822 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:35:59,109 INFO     | time:1057s total_exs:11008 total_steps:172 epochs:1.57 time_left:4322s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.74     1  1483  2059  .04688      6.413 44.44  448             32768  2.848   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.55  1.31 6.93e-06 689.7 957.9       0          0 3.704      .6948   
    token_em  total_train_updates  tpb  tps   ups  
      .02902                  172 2172 3017 .6958

2022-02-24 03:36:09,150 INFO     | time:1067s total_exs:11456 total_steps:179 epochs:1.64 time_left:4150s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.71     1  1467  2050  .04241      6.875 44.73  448             32768  2.763   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 22.31 1.269 6.93e-06   714 998.1       0          0 3.558      .7046   
    token_em  total_train_updates  tpb  tps   ups  
      .01339                  179 2181 3048 .7004

2022-02-24 03:36:19,262 INFO     | time:1077s total_exs:11904 total_steps:186 epochs:1.70 time_left:3991s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.08     1  1429  1984  .05357      4.411 44.42  448             32768  2.812   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2340 21.77 1.179 6.93e-06 696.7 967.2       0          0 3.252      .7222   
    token_em  total_train_updates  tpb  tps   ups  
      .03348                  186 2126 2952 .6956

2022-02-24 03:36:28,560 INFO     | time:1087s total_exs:12320 total_steps:192 epochs:1.76 time_left:3853s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   50.31     1  1495  2096  .04327      3.606 44.87  416             32768  2.785   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.16 1.244 6.93e-06 709.1 994.3       0          0 3.471      .7101   
    token_em  total_train_updates  tpb  tps   ups  
      .03846                  192 2204 3090 .6944

2022-02-24 03:36:28,560 INFO     | running eval: valid
2022-02-24 03:37:36,440 INFO     | eval completed in 67.88s
2022-02-24 03:37:36,441 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1315   .0420      3.583 29.47 2000    .1930 21.92 2.161 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2   646       0          0 8.679      .5380     .0025                  192   
     tpb  tps  
   665.5 1961

2022-02-24 03:37:36,441 REPORT   | did not beat best ppl: 8.5572 impatience: 3
2022-02-24 03:37:36,441 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:38:33,280 INFO     | time:1212s total_exs:12800 total_steps:200 epochs:1.83 time_left:4089s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   50.62     1  1469  2049  .03333        4.7 44.61  480             32768   2.83   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 22.56 1.203 6.93e-06 721.8  1006       0          0 3.329      .7138   
    token_em  total_train_updates  tpb  tps   ups  
       .0500                  200 2191 3055 .7451

2022-02-24 03:38:43,310 INFO     | time:1222s total_exs:13248 total_steps:207 epochs:1.89 time_left:3942s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.59     1  1472  2060  .03348      3.603 44.78  448             32768  2.858   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.57 1.159 6.93e-06 690.4 966.1       0          0 3.188      .7258   
    token_em  total_train_updates  tpb  tps   ups  
      .04241                  207 2162 3026 .7012

2022-02-24 03:38:53,870 INFO     | time:1232s total_exs:13728 total_steps:214 epochs:1.96 time_left:3794s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   50.02     1  1408  2006  .03958      6.023  45.6  480             32768  2.826   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.16  1.22 6.93e-06 709.1  1011       0          0 3.386      .7137   
    token_em  total_train_updates  tpb  tps   ups  
      .04167                  214 2117 3017 .7060

2022-02-24 03:39:01,714 INFO     | time:1240s total_exs:14080 total_steps:220 epochs:2.01 time_left:3692s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   46.93     1  1451  2084  .03125      1.588 45.96  352             32768  2.797   
    gpu_mem  llen  loss       lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.93 1.131 6.93e-06 701.9  1008       0          0 3.097      .7300   
    token_em  total_train_updates  tpb  tps   ups  
      .01989                  220 2153 3092 .7853

2022-02-24 03:39:01,714 INFO     | running eval: valid
2022-02-24 03:40:08,262 INFO     | eval completed in 66.55s
2022-02-24 03:40:08,262 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1342   .0420      3.583 30.06 2000    .1930 21.92 2.181 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 658.9       0          0 8.859      .5429         0                  220   
     tpb  tps  
   665.5 2001

Epoch     5: reducing learning rate of group 0 to 3.4650e-06.
2022-02-24 03:40:08,262 REPORT   | did not beat best ppl: 8.5572 impatience: 4
2022-02-24 03:40:08,262 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:41:06,700 INFO     | time:1365s total_exs:14560 total_steps:227 epochs:2.08 time_left:3885s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   45.28     1  1361  1952  .04375       2.75 45.89  480             32768   2.83   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.27  1.14 3.465e-06 712.6  1022       0          0 3.127      .7326   
    token_em  total_train_updates  tpb  tps   ups  
       .0500                  227 2073 2974 .7110

2022-02-24 03:41:17,245 INFO     | time:1375s total_exs:15040 total_steps:235 epochs:2.15 time_left:3746s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   54.61     1  1461  2084  .05417       8.95 45.65  480             32768  2.886   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.98 1.231 3.465e-06 703.2  1003       0          0 3.423      .7048   
    token_em  total_train_updates  tpb  tps   ups  
       .0375                  235 2164 3087 .7624

2022-02-24 03:41:27,522 INFO     | time:1386s total_exs:15488 total_steps:242 epochs:2.21 time_left:3625s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.84     1  1475  2015  .03571      3.737 43.71  448             32768  2.829   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.15 1.165 3.465e-06 708.7   968       0          0 3.206      .7263   
    token_em  total_train_updates  tpb  tps   ups  
      .02679                  242 2184 2983 .6839

2022-02-24 03:41:35,320 INFO     | time:1394s total_exs:15840 total_steps:247 epochs:2.26 time_left:3533s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.03     1  1457  2062  .04545      3.494 45.29  352             32768  2.751   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 22.41   1.1 3.465e-06 717.1  1015       0          0 3.004      .7409   
    token_em  total_train_updates  tpb  tps   ups  
      .04545                  247 2174 3077 .7001

2022-02-24 03:41:35,320 INFO     | running eval: valid
2022-02-24 03:42:42,503 INFO     | eval completed in 67.18s
2022-02-24 03:42:42,503 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1329   .0420      3.583 29.78 2000    .1930 21.92 2.187 3.465e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 652.7       0          0 8.909      .5445     .0020                  247   
     tpb  tps  
   665.5 1982

2022-02-24 03:42:42,503 REPORT   | did not beat best ppl: 8.5572 impatience: 5
2022-02-24 03:42:42,503 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:43:38,689 INFO     | time:1517s total_exs:16288 total_steps:254 epochs:2.33 time_left:3698s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.19     1  1535  2138  .04018       4.23 44.57  448             32768  2.904   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2340  21.6 1.146 3.465e-06 691.1 962.6       0          0 3.146      .7250   
    token_em  total_train_updates  tpb  tps   ups  
      .02902                  254 2226 3100 .7439

2022-02-24 03:43:48,902 INFO     | time:1527s total_exs:16736 total_steps:261 epochs:2.39 time_left:3583s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   44.88     1  1399  1923  .03571      1.172 43.99  448             32768  2.907   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2304  22.7 1.129 3.465e-06 726.3 998.4       0          0 3.093      .7327   
    token_em  total_train_updates  tpb  tps   ups  
      .03348                  261 2125 2921 .7384

2022-02-24 03:43:59,038 INFO     | time:1537s total_exs:17184 total_steps:268 epochs:2.45 time_left:3472s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   43.44     1  1348  1867  .01786      1.312 44.32  448             32768  2.875   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen  ppl  token_acc  \
      .2305 21.87 1.122 3.465e-06 699.8 969.2       0          0 3.07      .7314   
    token_em  total_train_updates  tpb  tps   ups  
      .04688                  268 2048 2836 .7384

2022-02-24 03:44:08,393 INFO     | time:1547s total_exs:17600 total_steps:275 epochs:2.51 time_left:3374s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.11     1  1485  2070  .05769      5.702  44.6  416             32768  2.785   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 22.15 1.055 3.465e-06 708.8 987.8       0          0 2.873      .7474   
    token_em  total_train_updates  tpb  tps   ups  
      .05529                  275 2194 3058 .7522

2022-02-24 03:44:08,393 INFO     | running eval: valid
2022-02-24 03:45:15,268 INFO     | eval completed in 66.87s
2022-02-24 03:45:15,268 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1335   .0420      3.583 29.91 2000    .1930 21.92 2.201 3.465e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 655.7       0          0 9.031      .5424     .0020                  275   
     tpb  tps  
   665.5 1991

2022-02-24 03:45:15,268 REPORT   | did not beat best ppl: 8.5572 impatience: 6
2022-02-24 03:45:15,268 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:46:11,119 INFO     | time:1669s total_exs:18048 total_steps:282 epochs:2.58 time_left:3510s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   47.53     1  1438  1998  .03348      2.585 44.45  448             32768  2.919   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2286 22.15 1.046 3.465e-06 708.6 984.4       0          0 2.846      .7490   
    token_em  total_train_updates  tpb  tps   ups  
      .04688                  282 2147 2983 .6959

2022-02-24 03:46:21,231 INFO     | time:1679s total_exs:18496 total_steps:289 epochs:2.64 time_left:3405s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
    47.4     1  1443  2003  .03795      2.301 44.42  448             32768  2.942   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 22.14 1.049 3.465e-06 708.6 983.6       0          0 2.856      .7478   
    token_em  total_train_updates  tpb  tps   ups  
      .04241                  289 2152 2987 .6954

2022-02-24 03:46:31,325 INFO     | time:1690s total_exs:18944 total_steps:296 epochs:2.71 time_left:3305s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.87     1  1449  2014  .04241      4.594  44.5  448             32768  2.942   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen  ppl  token_acc  \
      .2305 21.82 1.072 3.465e-06 698.2 970.9       0          0 2.92      .7494   
    token_em  total_train_updates  tpb  tps   ups  
      .04018                  296 2147 2985 .6965

2022-02-24 03:46:40,541 INFO     | time:1699s total_exs:19360 total_steps:302 epochs:2.77 time_left:3215s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   45.37     1  1370  1937  .04087       2.57 45.26  416             32768  2.948   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.39 1.064 3.465e-06 684.6 968.4       0          0 2.898      .7392   
    token_em  total_train_updates  tpb  tps   ups  
      .04567                  302 2054 2906 .7003

2022-02-24 03:46:40,541 INFO     | running eval: valid
2022-02-24 03:47:47,663 INFO     | eval completed in 67.12s
2022-02-24 03:47:47,663 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1330   .0420      3.583  29.8 2000    .1930 21.92 2.209 3.465e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 653.3       0          0 9.105      .5420     .0015                  302   
     tpb  tps  
   665.5 1983

2022-02-24 03:47:47,663 REPORT   | did not beat best ppl: 8.5572 impatience: 7
2022-02-24 03:47:47,663 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:48:43,353 INFO     | time:1822s total_exs:19808 total_steps:309 epochs:2.83 time_left:3328s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   48.72     1  1404  1967  .03571      4.835 44.82  448             32768  2.975   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2304 21.92 1.076 3.465e-06 701.3 982.2       0          0 2.933      .7377   
    token_em  total_train_updates  tpb  tps   ups  
      .01339                  309 2106 2949 .7541

2022-02-24 03:48:53,962 INFO     | time:1832s total_exs:20288 total_steps:317 epochs:2.90 time_left:3225s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
      48     1  1450  2055  .03542      2.692 45.35  480             32768   3.07   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.85 1.109 3.465e-06 699.1 990.8       0          0 3.033      .7315   
    token_em  total_train_updates  tpb  tps   ups  
       .0250                  317 2149 3046 .7571

2022-02-24 03:49:04,378 INFO     | time:1843s total_exs:20768 total_steps:324 epochs:2.97 time_left:3126s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   49.64     1  1374  1985  .04583      6.713 46.24  480             32768  3.077   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2276 22.14 1.106 3.465e-06 708.6  1024       0          0 3.021      .7340   
    token_em  total_train_updates  tpb  tps   ups  
      .04167                  324 2082 3009 .7165

2022-02-24 03:49:12,186 INFO     | time:1850s total_exs:21120 total_steps:330 epochs:3.02 time_left:3056s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   47.09     1  1423  2012  .03693      2.631 45.24  352             32768  3.063   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen  ppl  token_acc  \
      .2277 22.76 1.098 3.465e-06 728.2  1030       0          0    3      .7416   
    token_em  total_train_updates  tpb  tps   ups  
      .02557                  330 2151 3041 .7727

2022-02-24 03:49:12,186 INFO     | running eval: valid
2022-02-24 03:50:19,736 INFO     | eval completed in 67.55s
2022-02-24 03:50:19,736 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1322   .0420      3.583 29.61 2000    .1930 21.92 2.218 3.465e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 649.2       0          0 9.188      .5404     .0020                  330   
     tpb  tps  
   665.5 1971

Epoch     9: reducing learning rate of group 0 to 1.7325e-06.
2022-02-24 03:50:19,736 REPORT   | did not beat best ppl: 8.5572 impatience: 8
2022-02-24 03:50:19,736 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:51:16,801 INFO     | time:1975s total_exs:21600 total_steps:337 epochs:3.09 time_left:3145s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.59     1  1516  2226  .04375      5.227    47  480             32768  3.024   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.88 1.021 1.733e-06   700  1028       0          0 2.777      .7509   
    token_em  total_train_updates  tpb  tps   ups  
      .03333                  337 2216 3254 .7320

2022-02-24 03:51:27,227 INFO     | time:1985s total_exs:22112 total_steps:345 epochs:3.16 time_left:3043s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   48.27     1  1402  2158  .03516      4.441 49.24  512             32768  2.958   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305  22.4 1.048 1.733e-06 716.9  1103       0          0 2.851      .7480   
    token_em  total_train_updates  tpb  tps   ups  
      .03125                  345 2119 3261 .8136

2022-02-24 03:51:37,889 INFO     | time:1996s total_exs:22656 total_steps:354 epochs:3.24 time_left:2938s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   47.17     1  1394  2228  .03309      3.618 51.15  544             32768  3.038   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2334 22.23 1.003 1.733e-06 711.2  1137       0          0 2.727      .7539   
    token_em  total_train_updates  tpb  tps   ups  
       .0386                  354 2105 3365 .8470

2022-02-24 03:51:42,163 INFO     | time:2000s total_exs:22880 total_steps:357 epochs:3.27 time_left:2896s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
    50.2     1  1424  2344  .03571      5.714 52.69  224             32768  3.072   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.34 1.027 1.733e-06 682.9  1124       0          0 2.792      .7552   
    token_em  total_train_updates  tpb  tps   ups  
      .04911                  357 2106 3468 .8097

2022-02-24 03:51:42,164 INFO     | running eval: valid
2022-02-24 03:52:48,696 INFO     | eval completed in 66.53s
2022-02-24 03:52:48,696 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1342   .0420      3.583 30.07 2000    .1930 21.92 2.217 1.733e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 659.1       0          0 9.178      .5413     .0020                  357   
     tpb  tps  
   665.5 2001

2022-02-24 03:52:48,696 REPORT   | did not beat best ppl: 8.5572 impatience: 9
2022-02-24 03:52:48,696 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:53:44,905 INFO     | time:2123s total_exs:23392 total_steps:365 epochs:3.34 time_left:2960s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   48.76     1  1466  2341  .03711      2.949 51.11  512             32768  3.162   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 21.72 1.102 1.733e-06 695.1  1110       0          0 3.009      .7334   
    token_em  total_train_updates  tpb  tps   ups  
       .0332                  365 2161 3452 .8432

2022-02-24 03:53:54,992 INFO     | time:2133s total_exs:23904 total_steps:373 epochs:3.41 time_left:2864s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   52.17     1  1496  2380  .04688      5.426 50.91  512             32768  3.002   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2277 22.34 1.032 1.733e-06 714.9  1137       0          0 2.806      .7514   
    token_em  total_train_updates  tpb  tps   ups  
      .02539                  373 2211 3517 .8415

2022-02-24 03:54:05,035 INFO     | time:2143s total_exs:24416 total_steps:381 epochs:3.49 time_left:2772s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   48.91     1  1488  2377  .04297      2.408 51.11  512             32768  3.037   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305  22.4  1.04 1.733e-06 716.9  1145       0          0 2.831      .7480   
    token_em  total_train_updates  tpb  tps   ups  
       .0332                  381 2205 3522 .8450

2022-02-24 03:54:09,517 INFO     | time:2148s total_exs:24640 total_steps:385 epochs:3.52 time_left:2733s
    clen  clip  ctpb  ctps  ctrunc  ctrunclen  exps  exs  fp16_loss_scalar  gnorm  \
   54.03     1  1480  2323  .05357      7.781 50.23  224             32768  3.074   
    gpu_mem  llen  loss        lr  ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  \
      .2305 21.63 1.067 1.733e-06 692.1  1086       0          0 2.905      .7437   
    token_em  total_train_updates  tpb  tps   ups  
      .04911                  385 2172 3410 .8992

2022-02-24 03:54:09,518 INFO     | running eval: valid
2022-02-24 03:55:16,417 INFO     | eval completed in 66.90s
2022-02-24 03:55:16,417 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss        lr  \
   48.21 446.3  1335   .0420      3.583  29.9 2000    .1930 21.92  2.22 1.733e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2 655.5       0          0 9.206      .5419     .0015                  385   
     tpb  tps  
   665.5 1990

2022-02-24 03:55:16,417 REPORT   | did not beat best ppl: 8.5572 impatience: 10
2022-02-24 03:55:16,417 INFO     | saving model checkpoint: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.checkpoint
2022-02-24 03:56:02,465 INFO     | ran out of patience! stopping training.
2022-02-24 03:56:02,480 WARNING  | Overriding opt["init_model"] to zoo:blender/reddit_3B/model (previously: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model)
2022-02-24 03:56:02,480 WARNING  | Overriding opt["multitask_weights"] to (1.0, 3.0, 3.0, 3.0) (previously: [1.0, 3.0, 3.0, 3.0])
2022-02-24 03:56:02,483 WARNING  | your model is being loaded with opts that do not exist in the model you are initializing the weights with: allow_missing_init_opts: False,loglevel: info,is_debug: False,evaltask: None,final_extra_opt: ,eval_batchsize: 10,eval_dynamic_batching: None,num_workers: 0,display_examples: False,num_epochs: 8.0,max_train_time: 43200.0,max_train_steps: -1,log_every_n_steps: 50,validation_every_n_secs: -1,validation_every_n_steps: -1,save_every_n_secs: -1,save_after_valid: True,validation_every_n_epochs: 0.25,validation_max_exs: -1,short_final_eval: False,validation_patience: 10,validation_metric: ppl,validation_metric_mode: max,validation_cutoff: 1.0,validation_share_agent: False,metrics: default,aggregate_micro: False,tensorboard_log: False,tensorboard_logdir: None,wandb_log: False,wandb_name: None,wandb_project: None,wandb_entity: None,dict_maxexs: -1,dict_include_valid: False,dict_include_test: False,log_every_n_secs: 10.0,mutators: None,fromfile_datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data,fromfile_datatype_extension: True,checkpoint_activations: False,beam_block_full_context: True,beam_block_list_filename: None,history_reversed: False,special_tok_lst: None,bpe_dropout: None,dict_loaded: True,download_path: None,verbose: False,datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data,load_from_checkpoint: True,interactive_mode: False
2022-02-24 03:56:02,483 WARNING  | your model is being loaded with opts that differ from the model you are initializing the weights with. Add the following args to your run command to change this: 
--show-advanced-args False --task None --numthreads 1 --multitask-weights 1 --batchsize 1 --dropout 0.05 --model-parallel False --beam-size 10 --beam-min-length 20 --beam-context-block-ngram 3 --beam-block-ngram 3 --skip-generation False --fp16 False --fp16-impl apex --optimizer sgd --learningrate 1 --bpe-vocab /tmp/meena_converter/bpe-vocab.json --bpe-merge /tmp/meena_converter/bpe-merges.txt --bpe-add-prefix-space True --max-lr-steps -1 --warmup-updates -1 --update-freq 1 --parlai-home /private/home/roller/working/parlai
2022-02-24 03:56:02,485 INFO     | Using CUDA
2022-02-24 03:56:02,485 INFO     | loading dictionary from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model.dict
2022-02-24 03:56:02,499 INFO     | num words = 8008
2022-02-24 03:56:29,167 INFO     | Total parameters: 2,696,268,800 (2,695,613,440 trainable)
2022-02-24 03:56:29,167 INFO     | Loading existing model params from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative2/model
2022-02-24 03:59:13,167 INFO     | creating task(s): fromfile:parlaiformat
2022-02-24 03:59:13,168 INFO     | Loading ParlAI text data: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_valid.txt
2022-02-24 03:59:13,201 INFO     | running eval: valid
2022-02-24 04:00:20,354 INFO     | eval completed in 67.15s
2022-02-24 04:00:20,354 REPORT   | valid:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   48.21 446.3  1329   .0420      3.583 29.79 2000    .1771 21.92 2.147 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.2   653       0          0 8.557      .5391     .0025                  110   
     tpb  tps  
   665.5 1983

2022-02-24 04:00:20,356 INFO     | creating task(s): fromfile:parlaiformat
2022-02-24 04:00:20,357 INFO     | Loading ParlAI text data: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_test.txt
2022-02-24 04:00:20,419 INFO     | running eval: test
2022-02-24 04:01:35,228 INFO     | eval completed in 74.81s
2022-02-24 04:01:35,228 REPORT   | test:
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss       lr  \
   46.79 435.4  1263  .03089      3.225    29 2169    .1771 21.99  1.84 6.93e-06   
    ltpb  ltps  ltrunc  ltrunclen   ppl  token_acc  token_em  total_train_updates  \
   219.8 637.6       0          0 6.298      .5841         0                  110   
     tpb  tps  
   655.2 1901

2022-02-24 04:01:35,260 WARNING  | Overriding opt["datatype"] to valid (previously: train)
2022-02-24 04:01:35,260 WARNING  | Overriding opt["fromfile_datapath"] to /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_test.txt (previously: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data)
2022-02-24 04:01:35,262 INFO     | Using CUDA
2022-02-24 04:01:35,263 INFO     | loading dictionary from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict
2022-02-24 04:01:35,308 INFO     | num words = 8008
2022-02-24 04:02:00,216 INFO     | Total parameters: 2,696,268,800 (2,695,613,440 trainable)
2022-02-24 04:02:00,216 INFO     | Loading existing model params from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model
2022-02-24 04:05:23,985 INFO     | Opt:
2022-02-24 04:05:23,986 INFO     |     activation: gelu
2022-02-24 04:05:23,986 INFO     |     adafactor_eps: '[1e-30, 0.001]'
2022-02-24 04:05:23,986 INFO     |     adam_eps: 1e-08
2022-02-24 04:05:23,986 INFO     |     add_p1_after_newln: False
2022-02-24 04:05:23,986 INFO     |     aggregate_micro: False
2022-02-24 04:05:23,986 INFO     |     allow_missing_init_opts: False
2022-02-24 04:05:23,986 INFO     |     area_under_curve_class: None
2022-02-24 04:05:23,986 INFO     |     area_under_curve_digits: -1
2022-02-24 04:05:23,986 INFO     |     attention_dropout: 0.0
2022-02-24 04:05:23,986 INFO     |     batchsize: 32
2022-02-24 04:05:23,986 INFO     |     beam_block_full_context: True
2022-02-24 04:05:23,986 INFO     |     beam_block_list_filename: None
2022-02-24 04:05:23,986 INFO     |     beam_block_ngram: -1
2022-02-24 04:05:23,986 INFO     |     beam_context_block_ngram: -1
2022-02-24 04:05:23,986 INFO     |     beam_delay: 30
2022-02-24 04:05:23,986 INFO     |     beam_length_penalty: 0.65
2022-02-24 04:05:23,986 INFO     |     beam_min_length: 1
2022-02-24 04:05:23,986 INFO     |     beam_size: 1
2022-02-24 04:05:23,986 INFO     |     betas: '[0.9, 0.999]'
2022-02-24 04:05:23,986 INFO     |     bpe_add_prefix_space: None
2022-02-24 04:05:23,986 INFO     |     bpe_debug: False
2022-02-24 04:05:23,987 INFO     |     bpe_dropout: None
2022-02-24 04:05:23,987 INFO     |     bpe_merge: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict-merges.txt
2022-02-24 04:05:23,987 INFO     |     bpe_vocab: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict-vocab.json
2022-02-24 04:05:23,987 INFO     |     checkpoint_activations: False
2022-02-24 04:05:23,987 INFO     |     compute_tokenized_bleu: False
2022-02-24 04:05:23,987 INFO     |     datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data
2022-02-24 04:05:23,987 INFO     |     datatype: valid
2022-02-24 04:05:23,987 INFO     |     delimiter: '  '
2022-02-24 04:05:23,987 INFO     |     dict_class: parlai.core.dict:DictionaryAgent
2022-02-24 04:05:23,987 INFO     |     dict_endtoken: __end__
2022-02-24 04:05:23,987 INFO     |     dict_file: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict
2022-02-24 04:05:23,987 INFO     |     dict_include_test: False
2022-02-24 04:05:23,987 INFO     |     dict_include_valid: False
2022-02-24 04:05:23,987 INFO     |     dict_initpath: None
2022-02-24 04:05:23,987 INFO     |     dict_language: english
2022-02-24 04:05:23,987 INFO     |     dict_loaded: True
2022-02-24 04:05:23,987 INFO     |     dict_lower: False
2022-02-24 04:05:23,987 INFO     |     dict_max_ngram_size: -1
2022-02-24 04:05:23,987 INFO     |     dict_maxexs: -1
2022-02-24 04:05:23,987 INFO     |     dict_maxtokens: -1
2022-02-24 04:05:23,987 INFO     |     dict_minfreq: 0
2022-02-24 04:05:23,987 INFO     |     dict_nulltoken: __null__
2022-02-24 04:05:23,987 INFO     |     dict_starttoken: __start__
2022-02-24 04:05:23,987 INFO     |     dict_textfields: text,labels
2022-02-24 04:05:23,987 INFO     |     dict_tokenizer: bytelevelbpe
2022-02-24 04:05:23,987 INFO     |     dict_unktoken: __unk__
2022-02-24 04:05:23,987 INFO     |     display_examples: False
2022-02-24 04:05:23,987 INFO     |     download_path: None
2022-02-24 04:05:23,987 INFO     |     dropout: 0.1
2022-02-24 04:05:23,987 INFO     |     dynamic_batching: None
2022-02-24 04:05:23,988 INFO     |     embedding_projection: random
2022-02-24 04:05:23,988 INFO     |     embedding_size: 2560
2022-02-24 04:05:23,988 INFO     |     embedding_type: random
2022-02-24 04:05:23,988 INFO     |     embeddings_scale: True
2022-02-24 04:05:23,988 INFO     |     eval_batchsize: 10
2022-02-24 04:05:23,988 INFO     |     eval_dynamic_batching: None
2022-02-24 04:05:23,988 INFO     |     evaltask: None
2022-02-24 04:05:23,988 INFO     |     ffn_size: 10240
2022-02-24 04:05:23,988 INFO     |     final_extra_opt: 
2022-02-24 04:05:23,988 INFO     |     force_fp16_tokens: True
2022-02-24 04:05:23,988 INFO     |     fp16: True
2022-02-24 04:05:23,988 INFO     |     fp16_impl: safe
2022-02-24 04:05:23,988 INFO     |     fromfile_datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_test.txt
2022-02-24 04:05:23,988 INFO     |     fromfile_datatype_extension: True
2022-02-24 04:05:23,988 INFO     |     gpu: -1
2022-02-24 04:05:23,988 INFO     |     gradient_clip: 0.1
2022-02-24 04:05:23,988 INFO     |     hide_labels: False
2022-02-24 04:05:23,988 INFO     |     history_add_global_end_token: end
2022-02-24 04:05:23,988 INFO     |     history_reversed: False
2022-02-24 04:05:23,988 INFO     |     history_size: -1
2022-02-24 04:05:23,988 INFO     |     image_cropsize: 224
2022-02-24 04:05:23,988 INFO     |     image_mode: raw
2022-02-24 04:05:23,988 INFO     |     image_size: 256
2022-02-24 04:05:23,988 INFO     |     inference: greedy
2022-02-24 04:05:23,988 INFO     |     init_model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model
2022-02-24 04:05:23,988 INFO     |     init_opt: None
2022-02-24 04:05:23,988 INFO     |     interactive_mode: False
2022-02-24 04:05:23,988 INFO     |     invsqrt_lr_decay_gamma: -1
2022-02-24 04:05:23,988 INFO     |     is_debug: False
2022-02-24 04:05:23,988 INFO     |     label_truncate: 128
2022-02-24 04:05:23,989 INFO     |     learn_positional_embeddings: False
2022-02-24 04:05:23,989 INFO     |     learningrate: 7e-06
2022-02-24 04:05:23,989 INFO     |     log_every_n_secs: 10.0
2022-02-24 04:05:23,989 INFO     |     log_every_n_steps: 50
2022-02-24 04:05:23,989 INFO     |     log_keep_fields: all
2022-02-24 04:05:23,989 INFO     |     loglevel: info
2022-02-24 04:05:23,989 INFO     |     lr_scheduler: reduceonplateau
2022-02-24 04:05:23,989 INFO     |     lr_scheduler_decay: 0.5
2022-02-24 04:05:23,989 INFO     |     lr_scheduler_patience: 3
2022-02-24 04:05:23,989 INFO     |     max_train_steps: -1
2022-02-24 04:05:23,989 INFO     |     max_train_time: 43200.0
2022-02-24 04:05:23,989 INFO     |     metrics: default
2022-02-24 04:05:23,989 INFO     |     model: transformer/generator
2022-02-24 04:05:23,989 INFO     |     model_file: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model
2022-02-24 04:05:23,989 INFO     |     model_parallel: True
2022-02-24 04:05:23,989 INFO     |     momentum: 0
2022-02-24 04:05:23,989 INFO     |     multitask_weights: '[1.0, 3.0, 3.0, 3.0]'
2022-02-24 04:05:23,989 INFO     |     mutators: None
2022-02-24 04:05:23,989 INFO     |     n_decoder_layers: 24
2022-02-24 04:05:23,989 INFO     |     n_encoder_layers: 2
2022-02-24 04:05:23,989 INFO     |     n_heads: 32
2022-02-24 04:05:23,989 INFO     |     n_layers: 2
2022-02-24 04:05:23,989 INFO     |     n_positions: 128
2022-02-24 04:05:23,989 INFO     |     n_segments: 0
2022-02-24 04:05:23,989 INFO     |     nesterov: True
2022-02-24 04:05:23,989 INFO     |     no_cuda: False
2022-02-24 04:05:23,989 INFO     |     num_epochs: 8.0
2022-02-24 04:05:23,989 INFO     |     num_examples: -1
2022-02-24 04:05:23,989 INFO     |     num_workers: 0
2022-02-24 04:05:23,990 INFO     |     nus: [0.7]
2022-02-24 04:05:23,990 INFO     |     optimizer: adam
2022-02-24 04:05:23,990 INFO     |     output_scaling: 1.0
2022-02-24 04:05:23,990 INFO     |     override: "{'datatype': 'valid', 'task': 'fromfile:parlaiformat', 'fromfile_datapath': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_test.txt', 'model_file': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model'}"
2022-02-24 04:05:23,990 INFO     |     parlai_home: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages
2022-02-24 04:05:23,990 INFO     |     person_tokens: False
2022-02-24 04:05:23,990 INFO     |     rank_candidates: False
2022-02-24 04:05:23,990 INFO     |     relu_dropout: 0.0
2022-02-24 04:05:23,990 INFO     |     report_filename: 
2022-02-24 04:05:23,990 INFO     |     save_after_valid: True
2022-02-24 04:05:23,990 INFO     |     save_every_n_secs: -1
2022-02-24 04:05:23,990 INFO     |     save_format: conversations
2022-02-24 04:05:23,990 INFO     |     share_word_embeddings: True
2022-02-24 04:05:23,990 INFO     |     short_final_eval: False
2022-02-24 04:05:23,990 INFO     |     skip_generation: True
2022-02-24 04:05:23,990 INFO     |     special_tok_lst: None
2022-02-24 04:05:23,990 INFO     |     split_lines: False
2022-02-24 04:05:23,990 INFO     |     starttime: Feb10_01-49
2022-02-24 04:05:23,990 INFO     |     task: fromfile:parlaiformat
2022-02-24 04:05:23,990 INFO     |     temperature: 1.0
2022-02-24 04:05:23,990 INFO     |     tensorboard_log: False
2022-02-24 04:05:23,990 INFO     |     tensorboard_logdir: None
2022-02-24 04:05:23,990 INFO     |     text_truncate: 128
2022-02-24 04:05:23,990 INFO     |     topk: 10
2022-02-24 04:05:23,990 INFO     |     topp: 0.9
2022-02-24 04:05:23,990 INFO     |     truncate: 128
2022-02-24 04:05:23,990 INFO     |     update_freq: 2
2022-02-24 04:05:23,990 INFO     |     use_reply: label
2022-02-24 04:05:23,990 INFO     |     validation_cutoff: 1.0
2022-02-24 04:05:23,991 INFO     |     validation_every_n_epochs: 0.25
2022-02-24 04:05:23,991 INFO     |     validation_every_n_secs: -1
2022-02-24 04:05:23,991 INFO     |     validation_every_n_steps: -1
2022-02-24 04:05:23,991 INFO     |     validation_max_exs: -1
2022-02-24 04:05:23,991 INFO     |     validation_metric: ppl
2022-02-24 04:05:23,991 INFO     |     validation_metric_mode: max
2022-02-24 04:05:23,991 INFO     |     validation_patience: 10
2022-02-24 04:05:23,991 INFO     |     validation_share_agent: False
2022-02-24 04:05:23,991 INFO     |     variant: prelayernorm
2022-02-24 04:05:23,991 INFO     |     verbose: False
2022-02-24 04:05:23,991 INFO     |     wandb_entity: None
2022-02-24 04:05:23,991 INFO     |     wandb_log: False
2022-02-24 04:05:23,991 INFO     |     wandb_name: None
2022-02-24 04:05:23,991 INFO     |     wandb_project: None
2022-02-24 04:05:23,991 INFO     |     warmup_rate: 0.0001
2022-02-24 04:05:23,991 INFO     |     warmup_updates: 100
2022-02-24 04:05:23,991 INFO     |     weight_decay: None
2022-02-24 04:05:23,991 INFO     |     world_logs: 
2022-02-24 04:05:24,110 INFO     | Current ParlAI commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 04:05:24,224 INFO     | Current internal commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 04:05:24,330 INFO     | Current fb commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 04:05:24,330 INFO     | Evaluating task fromfile:parlaiformat using datatype valid.
2022-02-24 04:05:24,330 INFO     | creating task(s): fromfile:parlaiformat
2022-02-24 04:05:24,332 WARNING  | You are using this fromfile data as a valid or test set without setting fromfile_datatype_extension to true. Please be aware this uses directly the file you indicated, make sure this is not the same as your training file.
2022-02-24 04:05:24,332 INFO     | Loading ParlAI text data: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data_test.txt
2022-02-24 04:05:34,807 INFO     | 11.8% complete (255 / 2,169), 0:00:10 elapsed, 0:01:15 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
    48.6 44.35  1124  .03543      4.252 25.44  255    .1771 19.97 2.317 19.95 505.7   
    ltrunc  ltrunclen   ppl  token_acc  token_em  tpb  tps  
         0          0 10.15      .4961         0 64.3 1630
2022-02-24 04:05:44,841 INFO     | 23.7% complete (514 / 2,169), 0:00:20 elapsed, 0:01:05 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   47.05 44.64  1137   .0274      2.415 25.63  514   .01611 20.68 2.179 20.68 526.9   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 8.835      .5276         0 65.32 1664
2022-02-24 04:05:54,847 INFO     | 35.5% complete (769 / 2,169), 0:00:30 elapsed, 0:00:55 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   47.27 44.13  1124  .03133       3.14 25.58  769   .01611 20.82 2.034 20.82 530.6   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 7.647      .5490         0 64.95 1655
2022-02-24 04:06:04,881 INFO     | 47.3% complete (1,025 / 2,169), 0:00:40 elapsed, 0:00:45 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   47.09 44.14  1125  .03033      2.948 25.56 1025   .01611 21.23 1.929 21.23 541.2   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 6.883      .5678         0 65.37 1666
2022-02-24 04:06:14,906 INFO     | 59.1% complete (1,282 / 2,169), 0:00:50 elapsed, 0:00:35 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   48.19 44.67  1140   .0344      3.518 25.58 1282   .01611 21.66 1.871 21.66 552.8   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 6.493      .5795         0 66.34 1693
2022-02-24 04:06:24,924 INFO     | 71.0% complete (1,541 / 2,169), 0:01:00 elapsed, 0:00:25 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   47.98 44.34  1134  .03511      3.641 25.62 1541   .01612  21.8 1.846 21.81 557.7   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 6.331      .5840         0 66.14 1691
2022-02-24 04:06:34,925 INFO     | 83.0% complete (1,800 / 2,169), 0:01:10 elapsed, 0:00:14 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   47.51  44.1  1130  .03339       3.41 25.66 1800   .01611 21.98 1.848 21.98 563.1   
    ltrunc  ltrunclen  ppl  token_acc  token_em   tpb  tps  
         0          0 6.35      .5836         0 66.08 1693
2022-02-24 04:06:44,962 INFO     | 94.9% complete (2,059 / 2,169), 0:01:20 elapsed, 0:00:04 eta
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   47.31 43.91  1126  .03259      3.403 25.69 2059   .01611 21.94 1.813 21.94 562.7   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 6.131      .5894         0 65.84 1689
2022-02-24 04:06:49,208 INFO     | Finished evaluating tasks ['fromfile:parlaiformat'] using datatype valid
    clen  ctpb  ctps  ctrunc  ctrunclen  exps  exs  gpu_mem  llen  loss  ltpb  ltps  \
   46.85 43.62  1119  .03093       3.23 25.69 2169   .01608 21.99 1.829 21.99 564.1   
    ltrunc  ltrunclen   ppl  token_acc  token_em   tpb  tps  
         0          0 6.228      .5862         0 65.61 1683
2022-02-24 04:06:49,227 WARNING  | Overriding opt["fromfile_datapath"] to /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_trial.txt (previously: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_data)
2022-02-24 04:06:49,227 WARNING  | Overriding opt["force_fp16_tokens"] to True (previously: False)
2022-02-24 04:06:49,227 WARNING  | Overriding opt["skip_generation"] to False (previously: True)
2022-02-24 04:06:49,230 INFO     | Using CUDA
2022-02-24 04:06:49,230 INFO     | loading dictionary from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict
2022-02-24 04:06:49,244 INFO     | num words = 8008
2022-02-24 04:07:14,186 INFO     | Total parameters: 2,696,268,800 (2,695,613,440 trainable)
2022-02-24 04:07:14,186 INFO     | Loading existing model params from /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model
2022-02-24 04:08:27,897 INFO     | creating task(s): fromfile:parlaiformat
2022-02-24 04:08:27,899 WARNING  | You are using this fromfile data as a valid or test set without setting fromfile_datatype_extension to true. Please be aware this uses directly the file you indicated, make sure this is not the same as your training file.
2022-02-24 04:08:27,899 INFO     | Loading ParlAI text data: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_trial.txt
2022-02-24 04:08:27,913 INFO     | Opt:
2022-02-24 04:08:27,914 INFO     |     activation: gelu
2022-02-24 04:08:27,914 INFO     |     adafactor_eps: '[1e-30, 0.001]'
2022-02-24 04:08:27,914 INFO     |     adam_eps: 1e-08
2022-02-24 04:08:27,914 INFO     |     add_p1_after_newln: False
2022-02-24 04:08:27,914 INFO     |     aggregate_micro: False
2022-02-24 04:08:27,914 INFO     |     allow_missing_init_opts: False
2022-02-24 04:08:27,914 INFO     |     attention_dropout: 0.0
2022-02-24 04:08:27,914 INFO     |     batchsize: 32
2022-02-24 04:08:27,914 INFO     |     beam_block_full_context: True
2022-02-24 04:08:27,914 INFO     |     beam_block_list_filename: None
2022-02-24 04:08:27,914 INFO     |     beam_block_ngram: -1
2022-02-24 04:08:27,914 INFO     |     beam_context_block_ngram: -1
2022-02-24 04:08:27,914 INFO     |     beam_delay: 30
2022-02-24 04:08:27,914 INFO     |     beam_length_penalty: 0.65
2022-02-24 04:08:27,914 INFO     |     beam_min_length: 1
2022-02-24 04:08:27,914 INFO     |     beam_size: 1
2022-02-24 04:08:27,914 INFO     |     betas: '[0.9, 0.999]'
2022-02-24 04:08:27,914 INFO     |     bpe_add_prefix_space: None
2022-02-24 04:08:27,914 INFO     |     bpe_debug: False
2022-02-24 04:08:27,914 INFO     |     bpe_dropout: None
2022-02-24 04:08:27,914 INFO     |     bpe_merge: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict-merges.txt
2022-02-24 04:08:27,914 INFO     |     bpe_vocab: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict-vocab.json
2022-02-24 04:08:27,914 INFO     |     checkpoint_activations: False
2022-02-24 04:08:27,914 INFO     |     compute_tokenized_bleu: False
2022-02-24 04:08:27,914 INFO     |     datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data
2022-02-24 04:08:27,914 INFO     |     datatype: train
2022-02-24 04:08:27,914 INFO     |     delimiter: '  '
2022-02-24 04:08:27,915 INFO     |     dict_class: parlai.core.dict:DictionaryAgent
2022-02-24 04:08:27,915 INFO     |     dict_endtoken: __end__
2022-02-24 04:08:27,915 INFO     |     dict_file: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model.dict
2022-02-24 04:08:27,915 INFO     |     dict_include_test: False
2022-02-24 04:08:27,915 INFO     |     dict_include_valid: False
2022-02-24 04:08:27,915 INFO     |     dict_initpath: None
2022-02-24 04:08:27,915 INFO     |     dict_language: english
2022-02-24 04:08:27,915 INFO     |     dict_loaded: True
2022-02-24 04:08:27,915 INFO     |     dict_lower: False
2022-02-24 04:08:27,915 INFO     |     dict_max_ngram_size: -1
2022-02-24 04:08:27,915 INFO     |     dict_maxexs: -1
2022-02-24 04:08:27,915 INFO     |     dict_maxtokens: -1
2022-02-24 04:08:27,915 INFO     |     dict_minfreq: 0
2022-02-24 04:08:27,915 INFO     |     dict_nulltoken: __null__
2022-02-24 04:08:27,915 INFO     |     dict_starttoken: __start__
2022-02-24 04:08:27,915 INFO     |     dict_textfields: text,labels
2022-02-24 04:08:27,915 INFO     |     dict_tokenizer: bytelevelbpe
2022-02-24 04:08:27,915 INFO     |     dict_unktoken: __unk__
2022-02-24 04:08:27,915 INFO     |     display_add_fields: 
2022-02-24 04:08:27,915 INFO     |     display_examples: False
2022-02-24 04:08:27,915 INFO     |     download_path: None
2022-02-24 04:08:27,915 INFO     |     dropout: 0.1
2022-02-24 04:08:27,915 INFO     |     dynamic_batching: None
2022-02-24 04:08:27,915 INFO     |     embedding_projection: random
2022-02-24 04:08:27,915 INFO     |     embedding_size: 2560
2022-02-24 04:08:27,915 INFO     |     embedding_type: random
2022-02-24 04:08:27,915 INFO     |     embeddings_scale: True
2022-02-24 04:08:27,915 INFO     |     eval_batchsize: 10
2022-02-24 04:08:27,915 INFO     |     eval_dynamic_batching: None
2022-02-24 04:08:27,915 INFO     |     evaltask: None
2022-02-24 04:08:27,916 INFO     |     ffn_size: 10240
2022-02-24 04:08:27,916 INFO     |     final_extra_opt: 
2022-02-24 04:08:27,916 INFO     |     force_fp16_tokens: True
2022-02-24 04:08:27,916 INFO     |     fp16: True
2022-02-24 04:08:27,916 INFO     |     fp16_impl: safe
2022-02-24 04:08:27,916 INFO     |     fromfile_datapath: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_trial.txt
2022-02-24 04:08:27,916 INFO     |     fromfile_datatype_extension: True
2022-02-24 04:08:27,916 INFO     |     gpu: -1
2022-02-24 04:08:27,916 INFO     |     gradient_clip: 0.1
2022-02-24 04:08:27,916 INFO     |     hide_labels: False
2022-02-24 04:08:27,916 INFO     |     history_add_global_end_token: end
2022-02-24 04:08:27,916 INFO     |     history_reversed: False
2022-02-24 04:08:27,916 INFO     |     history_size: -1
2022-02-24 04:08:27,916 INFO     |     image_cropsize: 224
2022-02-24 04:08:27,916 INFO     |     image_mode: raw
2022-02-24 04:08:27,916 INFO     |     image_size: 256
2022-02-24 04:08:27,916 INFO     |     inference: greedy
2022-02-24 04:08:27,916 INFO     |     init_model: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages/data/models/blender/reddit_3B/model
2022-02-24 04:08:27,916 INFO     |     init_opt: None
2022-02-24 04:08:27,916 INFO     |     interactive_mode: False
2022-02-24 04:08:27,916 INFO     |     invsqrt_lr_decay_gamma: -1
2022-02-24 04:08:27,916 INFO     |     is_debug: False
2022-02-24 04:08:27,916 INFO     |     label_truncate: 128
2022-02-24 04:08:27,916 INFO     |     learn_positional_embeddings: False
2022-02-24 04:08:27,916 INFO     |     learningrate: 7e-06
2022-02-24 04:08:27,916 INFO     |     log_every_n_secs: 10.0
2022-02-24 04:08:27,916 INFO     |     log_every_n_steps: 50
2022-02-24 04:08:27,916 INFO     |     loglevel: info
2022-02-24 04:08:27,916 INFO     |     lr_scheduler: reduceonplateau
2022-02-24 04:08:27,916 INFO     |     lr_scheduler_decay: 0.5
2022-02-24 04:08:27,917 INFO     |     lr_scheduler_patience: 3
2022-02-24 04:08:27,917 INFO     |     max_train_steps: -1
2022-02-24 04:08:27,917 INFO     |     max_train_time: 43200.0
2022-02-24 04:08:27,917 INFO     |     metrics: default
2022-02-24 04:08:27,917 INFO     |     model: transformer/generator
2022-02-24 04:08:27,917 INFO     |     model_file: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model
2022-02-24 04:08:27,917 INFO     |     model_parallel: True
2022-02-24 04:08:27,917 INFO     |     momentum: 0
2022-02-24 04:08:27,917 INFO     |     multitask_weights: '[1.0, 3.0, 3.0, 3.0]'
2022-02-24 04:08:27,917 INFO     |     mutators: None
2022-02-24 04:08:27,917 INFO     |     n_decoder_layers: 24
2022-02-24 04:08:27,917 INFO     |     n_encoder_layers: 2
2022-02-24 04:08:27,917 INFO     |     n_heads: 32
2022-02-24 04:08:27,917 INFO     |     n_layers: 2
2022-02-24 04:08:27,917 INFO     |     n_positions: 128
2022-02-24 04:08:27,917 INFO     |     n_segments: 0
2022-02-24 04:08:27,917 INFO     |     nesterov: True
2022-02-24 04:08:27,917 INFO     |     no_cuda: False
2022-02-24 04:08:27,917 INFO     |     num_epochs: 8.0
2022-02-24 04:08:27,917 INFO     |     num_examples: 20
2022-02-24 04:08:27,917 INFO     |     num_workers: 0
2022-02-24 04:08:27,917 INFO     |     nus: [0.7]
2022-02-24 04:08:27,917 INFO     |     optimizer: adam
2022-02-24 04:08:27,917 INFO     |     output_scaling: 1.0
2022-02-24 04:08:27,917 INFO     |     override: "{'task': 'fromfile:parlaiformat', 'fromfile_datapath': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/data/gab_trial.txt', 'force_fp16_tokens': True, 'model_file': '/rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/counterspeech_project-NLP/generator_only/from_pretrained_generative/model', 'num_examples': '20', 'skip_generation': False}"
2022-02-24 04:08:27,917 INFO     |     parlai_home: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project/python3.8/lib/python3.8/site-packages
2022-02-24 04:08:27,917 INFO     |     person_tokens: False
2022-02-24 04:08:27,917 INFO     |     rank_candidates: False
2022-02-24 04:08:27,918 INFO     |     relu_dropout: 0.0
2022-02-24 04:08:27,918 INFO     |     save_after_valid: True
2022-02-24 04:08:27,918 INFO     |     save_every_n_secs: -1
2022-02-24 04:08:27,918 INFO     |     share_word_embeddings: True
2022-02-24 04:08:27,918 INFO     |     short_final_eval: False
2022-02-24 04:08:27,918 INFO     |     skip_generation: False
2022-02-24 04:08:27,918 INFO     |     special_tok_lst: None
2022-02-24 04:08:27,918 INFO     |     split_lines: False
2022-02-24 04:08:27,918 INFO     |     starttime: Feb10_01-49
2022-02-24 04:08:27,918 INFO     |     task: fromfile:parlaiformat
2022-02-24 04:08:27,918 INFO     |     temperature: 1.0
2022-02-24 04:08:27,918 INFO     |     tensorboard_log: False
2022-02-24 04:08:27,918 INFO     |     tensorboard_logdir: None
2022-02-24 04:08:27,918 INFO     |     text_truncate: 128
2022-02-24 04:08:27,918 INFO     |     topk: 10
2022-02-24 04:08:27,918 INFO     |     topp: 0.9
2022-02-24 04:08:27,918 INFO     |     truncate: 128
2022-02-24 04:08:27,918 INFO     |     update_freq: 2
2022-02-24 04:08:27,918 INFO     |     use_reply: label
2022-02-24 04:08:27,918 INFO     |     validation_cutoff: 1.0
2022-02-24 04:08:27,918 INFO     |     validation_every_n_epochs: 0.25
2022-02-24 04:08:27,918 INFO     |     validation_every_n_secs: -1
2022-02-24 04:08:27,918 INFO     |     validation_every_n_steps: -1
2022-02-24 04:08:27,918 INFO     |     validation_max_exs: -1
2022-02-24 04:08:27,918 INFO     |     validation_metric: ppl
2022-02-24 04:08:27,918 INFO     |     validation_metric_mode: max
2022-02-24 04:08:27,918 INFO     |     validation_patience: 10
2022-02-24 04:08:27,918 INFO     |     validation_share_agent: False
2022-02-24 04:08:27,918 INFO     |     variant: prelayernorm
2022-02-24 04:08:27,918 INFO     |     verbose: False
2022-02-24 04:08:27,919 INFO     |     wandb_entity: None
2022-02-24 04:08:27,919 INFO     |     wandb_log: False
2022-02-24 04:08:27,919 INFO     |     wandb_name: None
2022-02-24 04:08:27,919 INFO     |     wandb_project: None
2022-02-24 04:08:27,919 INFO     |     warmup_rate: 0.0001
2022-02-24 04:08:27,919 INFO     |     warmup_updates: 100
2022-02-24 04:08:27,919 INFO     |     weight_decay: None
2022-02-24 04:08:28,337 INFO     | Current ParlAI commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 04:08:28,452 INFO     | Current internal commit: 442784d765e0bc54f08ce32d4104c52c973a601e
2022-02-24 04:08:28,562 INFO     | Current fb commit: 442784d765e0bc54f08ce32d4104c52c973a601e
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
- - - NEW EPISODE: data/gab_trial.txt- - -
faggot
    labels: The term "faggot" is offensive to many people and so should not be used here.
     model: Please do not use terms that are offensive to sexual orientation and/or gender identity.
2022-02-24 04:09:00,894 INFO     | epoch done
Changed directory to /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project.

JobID: 55736224
======
Time: Thu 24 Feb 04:09:30 GMT 2022
Running on master node: gpu-q-43
Current directory: /rds/project/rds-Yuap0gjVpKM/jw2055/counterspeech-iib-project
/usr/bin/perl: symbol lookup error: /usr/local/software/slurm/slurm-19.05.5/lib64/perl5/auto/Slurm/Slurm.so: undefined symbol: Perl_xs_apiversion_bootcheck

Nodes allocated:
================


numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
 

